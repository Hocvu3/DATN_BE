#!/usr/bin/env zap-api-scan.py -t https://api.docuflow.id.vn -f openapi -c zap-auth-config.conf

# OWASP ZAP Authentication Configuration
# This script configures ZAP to authenticate with the API

# Context name
contextName = "DocuFlow API"

# Authentication configuration
auth:
  type: "json"
  loginUrl: "https://api.docuflow.id.vn/api/auth/login"
  loginRequestBody: '{"email":"hocvu2003@gmail.com","password":"hocvu"}'
  loggedInIndicator: "\\Qaccess_token\\E"
  loggedOutIndicator: "\\Q401\\E|\\Q403\\E"

# Session management
session:
  method: "jwt"
  tokenLocation: "header"
  headerName: "Authorization"
  headerValuePattern: "Bearer ${access_token}"

# Users for testing
users:
  - name: "test-admin"
    credentials:
      email: "hocvu2003@gmail.com"
      password: "hocvu"

# Include in context
includePaths:
  - "https://api.docuflow.id.vn/.*"

# Exclude from context (public endpoints)
excludePaths:
  - "https://api.docuflow.id.vn/api/auth/login"
  - "https://api.docuflow.id.vn/api/auth/register"
  - "https://api.docuflow.id.vn/api/auth/google.*"
  - "https://api.docuflow.id.vn/health"
  - "https://api.docuflow.id.vn/api"
  - "https://api.docuflow.id.vn/api/.*"
